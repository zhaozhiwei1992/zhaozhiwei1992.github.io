<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width">
<meta name="theme-color" content="#222"><meta name="generator" content="Hexo 7.3.0">

  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">



<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.2/css/all.min.css" integrity="sha256-XOqroi11tY4EFQMR9ZYwZWKj5ZXiftSx36RRuC3anlA=" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/3.1.1/animate.min.css" integrity="sha256-PR7ttpcvz8qrF57fur/yAx1qXMFJeJFiA6pSzWi0OIE=" crossorigin="anonymous">

<script class="next-config" data-name="main" type="application/json">{"hostname":"zhaozhiwei1992.github.io","root":"/","images":"/images","scheme":"Gemini","darkmode":false,"version":"8.20.0","exturl":false,"sidebar":{"position":"left","width_expanded":320,"width_dual_column":240,"display":"post","padding":18,"offset":12,"onmobile":false},"copycode":{"enable":false,"style":null,"show_result":false},"fold":{"enable":false,"height":500},"bookmark":{"enable":false,"color":"#222","save":"auto"},"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"stickytabs":false,"motion":{"enable":true,"async":false,"transition":{"menu_item":"fadeInDown","post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},"i18n":{"placeholder":"搜索...","empty":"没有找到任何搜索结果：${query}","hits_time":"找到 ${hits} 个搜索结果（用时 ${time} 毫秒）","hits":"找到 ${hits} 个搜索结果"}}</script><script src="/js/config.js"></script>

    <meta name="description" content="show me your code">
<meta property="og:type" content="website">
<meta property="og:title" content="离线de日常">
<meta property="og:url" content="http://zhaozhiwei1992.github.io/page/4/index.html">
<meta property="og:site_name" content="离线de日常">
<meta property="og:description" content="show me your code">
<meta property="og:locale" content="zh_CN">
<meta property="article:author" content="Mr.zhao">
<meta name="twitter:card" content="summary">


<link rel="canonical" href="http://zhaozhiwei1992.github.io/page/4/">



<script class="next-config" data-name="page" type="application/json">{"sidebar":"","isHome":true,"isPost":false,"lang":"zh-CN","comments":"","permalink":"","path":"page/4/index.html","title":""}</script>

<script class="next-config" data-name="calendar" type="application/json">""</script>
<title>离线de日常</title>
  








  <noscript>
    <link rel="stylesheet" href="/css/noscript.css">
  </noscript>
</head>

<body itemscope itemtype="http://schema.org/WebPage" class="use-motion">
  <div class="headband"></div>

  <main class="main">
    <div class="column">
      <header class="header" itemscope itemtype="http://schema.org/WPHeader"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="切换导航栏" role="button">
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <i class="logo-line"></i>
      <h1 class="site-title">离线de日常</h1>
      <i class="logo-line"></i>
    </a>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger" aria-label="搜索" role="button">
    </div>
  </div>
</div>



<nav class="site-nav">
  <ul class="main-menu menu"><li class="menu-item menu-item-home"><a href="/" rel="section"><i class="fa fa-home fa-fw"></i>首页</a></li><li class="menu-item menu-item-about"><a href="/about/" rel="section"><i class="fa fa-user fa-fw"></i>关于</a></li><li class="menu-item menu-item-tags"><a href="/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>标签</a></li><li class="menu-item menu-item-categories"><a href="/categories/" rel="section"><i class="fa fa-th fa-fw"></i>分类</a></li><li class="menu-item menu-item-archives"><a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>归档</a></li>
  </ul>
</nav>




</header>
        
  
  <aside class="sidebar">

    <div class="sidebar-inner sidebar-overview-active">
      <ul class="sidebar-nav">
        <li class="sidebar-nav-toc">
          文章目录
        </li>
        <li class="sidebar-nav-overview">
          站点概览
        </li>
      </ul>

      <div class="sidebar-panel-container">
        <!--noindex-->
        <div class="post-toc-wrap sidebar-panel">
        </div>
        <!--/noindex-->

        <div class="site-overview-wrap sidebar-panel">
          <div class="site-author animated" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <img class="site-author-image" itemprop="image" alt="Mr.zhao"
      src="/images/avatar.jpg">
  <p class="site-author-name" itemprop="name">Mr.zhao</p>
  <div class="site-description" itemprop="description">show me your code</div>
</div>
<div class="site-state-wrap animated">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
        <a href="/archives/">
          <span class="site-state-item-count">59</span>
          <span class="site-state-item-name">日志</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
          <a href="/categories/">
        <span class="site-state-item-count">33</span>
        <span class="site-state-item-name">分类</span></a>
      </div>
      <div class="site-state-item site-state-tags">
          <a href="/tags/">
        <span class="site-state-item-count">88</span>
        <span class="site-state-item-name">标签</span></a>
      </div>
  </nav>
</div>
  <div class="links-of-author animated">
      <span class="links-of-author-item">
        <a href="https://github.com/zhaozhiwei1992" title="GitHub → https:&#x2F;&#x2F;github.com&#x2F;zhaozhiwei1992" rel="noopener me" target="_blank"><i class="fab fa-github fa-fw"></i>GitHub</a>
      </span>
      <span class="links-of-author-item">
        <a href="https://www.zhihu.com/people/p205/posts" title="知乎 → https:&#x2F;&#x2F;www.zhihu.com&#x2F;people&#x2F;p205&#x2F;posts" rel="noopener me" target="_blank"><i class="fab fa-zhihu fa-fw"></i>知乎</a>
      </span>
      <span class="links-of-author-item">
        <a href="https://www.jianshu.com/u/65f51bc73109" title="简书 → https:&#x2F;&#x2F;www.jianshu.com&#x2F;u&#x2F;65f51bc73109" rel="noopener me" target="_blank"><i class="fas fa-book-open fa-fw"></i>简书</a>
      </span>
      <span class="links-of-author-item">
        <a href="https://www.cnblogs.com/qq347061329" title="博客园 → https:&#x2F;&#x2F;www.cnblogs.com&#x2F;qq347061329" rel="noopener me" target="_blank"><i class="fab fa-blog fa-fw"></i>博客园</a>
      </span>
      <span class="links-of-author-item">
        <a href="https://blog.csdn.net/u012768510" title="CSDN → https:&#x2F;&#x2F;blog.csdn.net&#x2F;u012768510" rel="noopener me" target="_blank"><i class="fas fa-code fa-fw"></i>CSDN</a>
      </span>
      <span class="links-of-author-item">
        <a href="mailto:zhaozhiweishanxi@gmail.com" title="E-Mail → mailto:zhaozhiweishanxi@gmail.com" rel="noopener me" target="_blank"><i class="fa fa-envelope fa-fw"></i>E-Mail</a>
      </span>
  </div>

        </div>
      </div>
    </div>

    
  </aside>


    </div>

    <div class="main-inner index posts-expand">

    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="http://zhaozhiwei1992.github.io/2022/04/25/atomikos%E5%AE%9E%E7%8E%B0%E5%88%86%E5%B8%83%E5%BC%8F%E4%BA%8B%E5%8A%A1/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.jpg">
      <meta itemprop="name" content="Mr.zhao">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="离线de日常">
      <meta itemprop="description" content="show me your code">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | 离线de日常">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2022/04/25/atomikos%E5%AE%9E%E7%8E%B0%E5%88%86%E5%B8%83%E5%BC%8F%E4%BA%8B%E5%8A%A1/" class="post-title-link" itemprop="url">atomikos实现分布式事务</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2022-04-25 00:00:00" itemprop="dateCreated datePublished" datetime="2022-04-25T00:00:00+08:00">2022-04-25</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">更新于</span>
      <time title="修改时间：2025-11-12 15:40:02" itemprop="dateModified" datetime="2025-11-12T15:40:02+08:00">2025-11-12</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">分类于</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/java/" itemprop="url" rel="index"><span itemprop="name">java</span></a>
        </span>
          ，
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/java/%E7%BC%96%E7%A8%8B/" itemprop="url" rel="index"><span itemprop="name">编程</span></a>
        </span>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <h1 id="概述"><a href="#概述" class="headerlink" title="概述"></a>概述</h1><p>多数据源单服务写入, 分布式事务实现</p>
<p>使用随机数控制产生异常</p>
<p><strong>注: 网上很多都是只有多数据源配置，实际不能控制事务统一回滚,<br>单服务场景下如果多个数据源只有一个写，剩下都是读, 则不需要分布式事务</strong></p>
<p>为减少篇幅，详细代码在代码仓库，可自行参考</p>
<h1 id="版本"><a href="#版本" class="headerlink" title="版本"></a>版本</h1><p>springboot 2.1.7.RELEASE</p>
<h1 id="配置引入"><a href="#配置引入" class="headerlink" title="配置引入"></a>配置引入</h1><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">&lt;dependency&gt;</span><br><span class="line">  &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;</span><br><span class="line">  &lt;artifactId&gt;spring-boot-starter-data-jpa&lt;/artifactId&gt;</span><br><span class="line">&lt;/dependency&gt;</span><br><span class="line"></span><br><span class="line">&lt;dependency&gt;</span><br><span class="line">  &lt;groupId&gt;mysql&lt;/groupId&gt;</span><br><span class="line">  &lt;artifactId&gt;mysql-connector-java&lt;/artifactId&gt;</span><br><span class="line">&lt;/dependency&gt;</span><br><span class="line"></span><br><span class="line">&lt;dependency&gt;</span><br><span class="line">  &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;</span><br><span class="line">  &lt;artifactId&gt;spring-boot-starter-jta-atomikos&lt;/artifactId&gt;</span><br><span class="line">&lt;/dependency&gt;</span><br></pre></td></tr></table></figure>

<h1 id="增加配置类"><a href="#增加配置类" class="headerlink" title="增加配置类"></a>增加配置类</h1><p>AtomikosJtaPlatform</p>
<p>JPAAtomikosTransactionConfig Atomikos事务配置类</p>
<p>PrimaryConfig 主数据源配置</p>
<p>SecondaryConfig 其它数据源配置</p>
<h1 id="数据对象实现"><a href="#数据对象实现" class="headerlink" title="数据对象实现"></a>数据对象实现</h1><p>User</p>
<h1 id="增加仓储实现"><a href="#增加仓储实现" class="headerlink" title="增加仓储实现"></a>增加仓储实现</h1><p><strong>需要分别实现primary和secondary, 从而支持多个数据源访问</strong></p>
<p>PrimaryUserRepository</p>
<p>SecondaryUserRepository</p>
<h1 id="实现服务类"><a href="#实现服务类" class="headerlink" title="实现服务类"></a>实现服务类</h1><p>PrimaryUserService</p>
<p>SecondaryUserService</p>
<h2 id="ExampleService"><a href="#ExampleService" class="headerlink" title="ExampleService"></a>ExampleService</h2><p>负责统一调用 PrimaryUserService 和 SecondaryUserService,<br>模拟一个服务同时访问多个服务类(<strong>每个服务类引用了不同数据源</strong>)</p>
<p>如果其中某个服务抛出异常，则整个事务回滚, @Transactional(rollbackOn &#x3D;<br>Exception.class) 是必须的</p>
<h1 id="测试"><a href="#测试" class="headerlink" title="测试"></a>测试</h1><p>com.example.springbootatomikos.services.UserServiceTest#testSave</p>
<h1 id="代码"><a href="#代码" class="headerlink" title="代码"></a>代码</h1><p><a href="https://github.com/zhaozhiwei1992/demo/tree/master/springboot/springboot-atomikos">github地址</a></p>
<p><a href="https://gitee.com/zhaozhiwei_1992/demo/tree/master/springboot/springboot-atomikos">gitee地址</a></p>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="http://zhaozhiwei1992.github.io/2022/04/13/%E6%8C%87%E7%BA%B9%E8%AF%86%E5%88%AB%E6%94%AF%E6%8C%81/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.jpg">
      <meta itemprop="name" content="Mr.zhao">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="离线de日常">
      <meta itemprop="description" content="show me your code">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | 离线de日常">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2022/04/13/%E6%8C%87%E7%BA%B9%E8%AF%86%E5%88%AB%E6%94%AF%E6%8C%81/" class="post-title-link" itemprop="url">T480指纹识别支持</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2022-04-13 00:00:00" itemprop="dateCreated datePublished" datetime="2022-04-13T00:00:00+08:00">2022-04-13</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">更新于</span>
      <time title="修改时间：2025-11-12 15:40:02" itemprop="dateModified" datetime="2025-11-12T15:40:02+08:00">2025-11-12</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">分类于</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/%E8%BD%AF%E4%BB%B6/" itemprop="url" rel="index"><span itemprop="name">软件</span></a>
        </span>
          ，
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/%E8%BD%AF%E4%BB%B6/%E5%B7%A5%E5%85%B7/" itemprop="url" rel="index"><span itemprop="name">工具</span></a>
        </span>
          ，
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/%E8%BD%AF%E4%BB%B6/%E5%B7%A5%E5%85%B7/%E6%8C%87%E7%BA%B9%E8%AF%86%E5%88%AB/" itemprop="url" rel="index"><span itemprop="name">指纹识别</span></a>
        </span>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <h1 id="目标"><a href="#目标" class="headerlink" title="目标"></a>目标</h1><p>通过指纹识别解锁slim-lock</p>
<h1 id="环境"><a href="#环境" class="headerlink" title="环境"></a>环境</h1><h2 id="操作系统archlinux"><a href="#操作系统archlinux" class="headerlink" title="操作系统archlinux"></a>操作系统archlinux</h2><h2 id="桌面管理器slim"><a href="#桌面管理器slim" class="headerlink" title="桌面管理器slim"></a>桌面管理器slim</h2><h2 id="锁屏slimlock"><a href="#锁屏slimlock" class="headerlink" title="锁屏slimlock"></a>锁屏slimlock</h2><h2 id="硬件-Thinkpad-T480"><a href="#硬件-Thinkpad-T480" class="headerlink" title="硬件 Thinkpad T480"></a>硬件 Thinkpad T480</h2><p><strong>注: 指纹设备id, 06cb:009a</strong></p>
<h1 id="安装"><a href="#安装" class="headerlink" title="安装"></a>安装</h1><h2 id="测试设备-lsusb"><a href="#测试设备-lsusb" class="headerlink" title="测试设备 lsusb"></a>测试设备 lsusb</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">Bus 004 Device 001: ID 1d6b:0003 Linux Foundation 3.0 root hub</span><br><span class="line">Bus 003 Device 001: ID 1d6b:0002 Linux Foundation 2.0 root hub</span><br><span class="line">Bus 002 Device 002: ID 0bda:0316 Realtek Semiconductor Corp. Card Reader</span><br><span class="line">Bus 002 Device 001: ID 1d6b:0003 Linux Foundation 3.0 root hub</span><br><span class="line"></span><br><span class="line"># 这玩意儿应该就是指纹设备了</span><br><span class="line">Bus 001 Device 005: ID 06cb:009a Synaptics, Inc. Metallica MIS Touch Fingerprint Reader</span><br><span class="line"></span><br><span class="line">Bus 001 Device 004: ID 04f2:b604 Chicony Electronics Co., Ltd Integrated Camera (1280x720@30)</span><br><span class="line">Bus 001 Device 003: ID 8087:0a2b Intel Corp. Bluetooth wireless interface</span><br><span class="line">Bus 001 Device 002: ID 3044:50e0 MIIIW MW Keyboard Air Mini</span><br><span class="line">Bus 001 Device 001: ID 1d6b:0002 Linux Foundation 2.0 root hub</span><br></pre></td></tr></table></figure>

<h2 id="安装libfprint-vfs009x-git-测试不通过"><a href="#安装libfprint-vfs009x-git-测试不通过" class="headerlink" title="安装libfprint-vfs009x-git (测试不通过)"></a>安装libfprint-vfs009x-git (测试不通过)</h2><p>yaourt -S libfprint-vfs009x-git</p>
<h2 id="python-vlidity-推荐"><a href="#python-vlidity-推荐" class="headerlink" title="python-vlidity(推荐)"></a>python-vlidity(推荐)</h2><p><a href="https://github.com/uunicorn/python-validity">https://github.com/uunicorn/python-validity</a></p>
<p>安装: yaourt -S python-validity</p>
<h1 id="录入指纹及解锁"><a href="#录入指纹及解锁" class="headerlink" title="录入指纹及解锁"></a>录入指纹及解锁</h1><h2 id="fprintd-enroll"><a href="#fprintd-enroll" class="headerlink" title="fprintd-enroll"></a>fprintd-enroll</h2><p>按照下述同时，录入指纹，直到completed</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">Using device /net/reactivated/Fprint/Device/1</span><br><span class="line">Enrolling right-index-finger finger.</span><br><span class="line">Enroll result: enroll-stage-passed</span><br><span class="line">Enroll result: enroll-stage-passed</span><br><span class="line">Enroll result: enroll-stage-passed</span><br><span class="line">Enroll result: enroll-stage-passed</span><br><span class="line">Enroll result: enroll-stage-passed</span><br><span class="line">Enroll result: enroll-stage-passed</span><br><span class="line">Enroll result: enroll-stage-passed</span><br><span class="line">Enroll result: enroll-stage-passed</span><br><span class="line">Enroll result: enroll-completed</span><br></pre></td></tr></table></figure>

<h2 id="校验指纹是否正常fprintd-verify"><a href="#校验指纹是否正常fprintd-verify" class="headerlink" title="校验指纹是否正常fprintd-verify"></a>校验指纹是否正常fprintd-verify</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">Using device /net/reactivated/Fprint/Device/1</span><br><span class="line">Listing enrolled fingers:</span><br><span class="line"> - #0: WINBIO_ANSI_381_POS_RH_INDEX_FINGER</span><br><span class="line">Verify result: verify-match (done)</span><br></pre></td></tr></table></figure>

<h2 id="查看当前用户指纹-fprintd-list-用户名"><a href="#查看当前用户指纹-fprintd-list-用户名" class="headerlink" title="查看当前用户指纹 fprintd-list 用户名"></a>查看当前用户指纹 fprintd-list 用户名</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">found 1 devices</span><br><span class="line">Device at /net/reactivated/Fprint/Device/1</span><br><span class="line">Using device /net/reactivated/Fprint/Device/1</span><br><span class="line">Fingerprints for user zhaozhiwei on DBus driver (press):</span><br><span class="line"> - #0: WINBIO_ANSI_381_POS_RH_INDEX_FINGER</span><br></pre></td></tr></table></figure>

<h2 id="ThinkPadT480-slimlock指纹解锁"><a href="#ThinkPadT480-slimlock指纹解锁" class="headerlink" title="ThinkPadT480 slimlock指纹解锁"></a>ThinkPadT480 slimlock指纹解锁</h2><p>vim &#x2F;etc&#x2F;pam.d&#x2F;system-local-login</p>
<p>将pam_fprintd.so添加到auth部分的顶部</p>
<p>auth sufficient pam_fprintd.so</p>
<p>重新启动计算机，会提示扫描手指以解锁登录(指纹灯亮)</p>
<h3 id="注"><a href="#注" class="headerlink" title="注"></a>注</h3><p>slimlock认证后直接回车，不需要输入密码</p>
<h1 id="问题列表"><a href="#问题列表" class="headerlink" title="问题列表"></a>问题列表</h1><h2 id="Impossible-to-enroll-GDBus-Error-net-reactivated-Fprint-Error-NoSuchDevice-No-devices-available"><a href="#Impossible-to-enroll-GDBus-Error-net-reactivated-Fprint-Error-NoSuchDevice-No-devices-available" class="headerlink" title="Impossible to enroll: GDBus.Error:net.reactivated.Fprint.Error.NoSuchDevice: No devices available"></a>Impossible to enroll: GDBus.Error:net.reactivated.Fprint.Error.NoSuchDevice: No devices available</h2><p>运行fprintd-enroll报错</p>
<p><a href="https://wiki.archlinux.org/title/Lenovo_ThinkPad_T470#Fingerprint_reader">https://wiki.archlinux.org/title/Lenovo_ThinkPad_T470#Fingerprint_reader</a></p>
<p>Install fprintd and libfprint-vfs009x-git AUR, then reboot. You can now<br>enroll your fingers with fprintd-enroll.</p>
<h2 id="github下载很慢"><a href="#github下载很慢" class="headerlink" title="github下载很慢"></a>github下载很慢</h2><p>将repository导入到gitee中，并且注意该项目有子模块,<br>所有需要手动增加.gitmodules</p>
<p><a href="https://gitee.com/zhaozhiwei_1992/libfprint.git">https://gitee.com/zhaozhiwei_1992/libfprint.git</a></p>
<p><a href="https://gitee.com/zhaozhiwei_1992/libfprint-tod-vfs0090.git">https://gitee.com/zhaozhiwei_1992/libfprint-tod-vfs0090.git</a></p>
<h2 id="libfprint-meson-build-1-0-ERROR-Unknown-options-x11-examples"><a href="#libfprint-meson-build-1-0-ERROR-Unknown-options-x11-examples" class="headerlink" title="libfprint&#x2F;meson.build:1:0: ERROR: Unknown options: &quot;x11-examples&quot;"></a>libfprint&#x2F;meson.build:1:0: ERROR: Unknown options: &quot;x11-examples&quot;</h2><p>The x11-examples option seems to have been removed. It looks like it&#39;s<br>been replaced by &quot;gtk-examples&quot;. I edited that in PKGBUILD and it<br>built successfully.</p>
<p><a href="https://aur.archlinux.org/packages/libfprint-vfs009x-git">https://aur.archlinux.org/packages/libfprint-vfs009x-git</a></p>
<p>修改build文件, x11-example改成gtk-example</p>
<h2 id="libfprint-vfs009x-git和fprintd-1-92-版本冲突"><a href="#libfprint-vfs009x-git和fprintd-1-92-版本冲突" class="headerlink" title="libfprint-vfs009x-git和fprintd &gt;&#x3D;1.92+版本冲突"></a>libfprint-vfs009x-git和fprintd &gt;&#x3D;1.92+版本冲突</h2><p>安装低版本 sudo pacman -U<br><a href="https://archive.archlinux.org/packages/f/fprintd/fprintd-1.90.1-1-x86_64.pkg.tar.zst">https://archive.archlinux.org/packages/f/fprintd/fprintd-1.90.1-1-x86_64.pkg.tar.zst</a></p>
<h2 id="list-devices-failed-No-devices-available"><a href="#list-devices-failed-No-devices-available" class="headerlink" title="list_devices failed: No devices available"></a>list_devices failed: No devices available</h2><p>thinkpad t480 指纹id为 06cb:009a, 上述一些工具不支持,<br>直接使用python-validity即可</p>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="http://zhaozhiwei1992.github.io/2022/04/10/%E4%BA%BA%E8%84%B8%E8%AF%86%E5%88%AB%E5%AE%9E%E7%8E%B0%E5%B1%8F%E5%B9%95%E9%94%81%E5%AE%9A%E8%A7%A3%E9%94%81/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.jpg">
      <meta itemprop="name" content="Mr.zhao">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="离线de日常">
      <meta itemprop="description" content="show me your code">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | 离线de日常">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2022/04/10/%E4%BA%BA%E8%84%B8%E8%AF%86%E5%88%AB%E5%AE%9E%E7%8E%B0%E5%B1%8F%E5%B9%95%E9%94%81%E5%AE%9A%E8%A7%A3%E9%94%81/" class="post-title-link" itemprop="url">人脸识别实现屏幕锁定解锁</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2022-04-10 00:00:00" itemprop="dateCreated datePublished" datetime="2022-04-10T00:00:00+08:00">2022-04-10</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">更新于</span>
      <time title="修改时间：2025-11-12 15:40:02" itemprop="dateModified" datetime="2025-11-12T15:40:02+08:00">2025-11-12</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">分类于</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/python/" itemprop="url" rel="index"><span itemprop="name">python</span></a>
        </span>
          ，
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/python/%E4%BA%BA%E8%84%B8%E8%AF%86%E5%88%AB/" itemprop="url" rel="index"><span itemprop="name">人脸识别</span></a>
        </span>
          ，
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/python/%E4%BA%BA%E8%84%B8%E8%AF%86%E5%88%AB/opencv/" itemprop="url" rel="index"><span itemprop="name">opencv</span></a>
        </span>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <h1 id="环境"><a href="#环境" class="headerlink" title="环境"></a>环境</h1><h2 id="archlinux"><a href="#archlinux" class="headerlink" title="archlinux"></a>archlinux</h2><h3 id="桌面管理器i3wm"><a href="#桌面管理器i3wm" class="headerlink" title="桌面管理器i3wm"></a>桌面管理器i3wm</h3><h3 id="登录管理器-slim"><a href="#登录管理器-slim" class="headerlink" title="登录管理器 slim"></a>登录管理器 slim</h3><h2 id="python-3-10-4"><a href="#python-3-10-4" class="headerlink" title="python 3.10.4"></a>python 3.10.4</h2><h2 id="dlib"><a href="#dlib" class="headerlink" title="dlib"></a>dlib</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pip install --user -i https://pypi.tuna.tsinghua.edu.cn/simple dlib</span><br></pre></td></tr></table></figure>

<h2 id="face-recognition-依赖dlib"><a href="#face-recognition-依赖dlib" class="headerlink" title="face_recognition 依赖dlib"></a>face_recognition 依赖dlib</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pip install --user -i https://pypi.tuna.tsinghua.edu.cn/simple face_recognition</span><br></pre></td></tr></table></figure>

<h2 id="opency-读取摄像头"><a href="#opency-读取摄像头" class="headerlink" title="opency 读取摄像头"></a>opency 读取摄像头</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pip install --user -i https://pypi.tuna.tsinghua.edu.cn/simple opencv-python</span><br></pre></td></tr></table></figure>

<h2 id="笔记本内置摄像头"><a href="#笔记本内置摄像头" class="headerlink" title="笔记本内置摄像头"></a>笔记本内置摄像头</h2><h1 id="流程图"><a href="#流程图" class="headerlink" title="流程图"></a>流程图</h1><p><img src="/images/%E4%BA%BA%E8%84%B8%E8%AF%86%E5%88%AB/xx.png"></p>
<h1 id="代码"><a href="#代码" class="headerlink" title="代码"></a>代码</h1><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">人脸识别认证</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">使用摄像头检验当前用户是否匹配</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="comment"># -*- coding: utf-8 -*-</span></span><br><span class="line"><span class="keyword">import</span> cv2</span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">import</span> face_recognition</span><br><span class="line"><span class="keyword">import</span> pyautogui</span><br><span class="line"><span class="keyword">import</span> time</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">AuthByFace</span>:</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self, clicked, clocked</span>):</span><br><span class="line">        <span class="variable language_">self</span>.clicked = clicked</span><br><span class="line">        <span class="variable language_">self</span>.clocked = clocked</span><br><span class="line">        <span class="comment"># 设置图像保存目录</span></span><br><span class="line">        <span class="variable language_">self</span>.SUCCESS_DIR = os.environ[<span class="string">&#x27;HOME&#x27;</span>] + <span class="string">&quot;/Pictures/authFaces/success/&quot;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># 认证通过返回true</span></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">isAuthSuccess</span>(<span class="params">self</span>):</span><br><span class="line"></span><br><span class="line">        <span class="comment"># 获取摄像头中人脸</span></span><br><span class="line">        cameraCapture = cv2.VideoCapture(<span class="number">0</span>)</span><br><span class="line">        result, image = cameraCapture.read()</span><br><span class="line">        <span class="keyword">if</span> result:</span><br><span class="line">            <span class="comment"># cameraImageRgb = image[:, :, ::-1]</span></span><br><span class="line">            <span class="comment"># 摄像头中的人脸位置, 可能出现多张脸</span></span><br><span class="line">            cameraImageFaceLocations = face_recognition.face_locations(image)</span><br><span class="line">            <span class="comment"># 摄像头中人脸进行编码</span></span><br><span class="line">            cameraImageEncodings = face_recognition.face_encodings(image, cameraImageFaceLocations)[<span class="number">0</span>]</span><br><span class="line"></span><br><span class="line">            <span class="comment"># 使用仓库中文件 测试匹配</span></span><br><span class="line">            <span class="comment"># unknownImage = face_recognition.load_image_file(self.SUCCESS_DIR + &quot;image_1.jpg&quot;)</span></span><br><span class="line">            <span class="comment"># cameraImageEncodings = face_recognition.face_encodings(unknownImage)[0]</span></span><br><span class="line"></span><br><span class="line">            personNames = []</span><br><span class="line">            knownImageEncodings = []</span><br><span class="line">            <span class="comment"># 跟所有保存的人脸比对</span></span><br><span class="line">            files = os.listdir(<span class="variable language_">self</span>.SUCCESS_DIR)</span><br><span class="line">            <span class="keyword">for</span> file <span class="keyword">in</span> files:</span><br><span class="line">                <span class="keyword">if</span> file.endswith(<span class="string">&quot;jpg&quot;</span>) <span class="keyword">or</span> file.endswith(<span class="string">&quot;png&quot;</span>):</span><br><span class="line">                    name, _ = os.path.split(file)</span><br><span class="line">                    personNames.append(name)</span><br><span class="line">                    knowImagePath = <span class="variable language_">self</span>.SUCCESS_DIR + file</span><br><span class="line">                    knownImage = face_recognition.load_image_file(knowImagePath)</span><br><span class="line">                    <span class="comment"># 将仓库中照片全部编码, 后续比对需要</span></span><br><span class="line">                    knownImageEncodings.append(face_recognition.face_encodings(knownImage)[<span class="number">0</span>])</span><br><span class="line"></span><br><span class="line">            <span class="comment"># 遍历locations，face_encodings，识别图片中的人脸</span></span><br><span class="line">            matchs = face_recognition.compare_faces(knownImageEncodings, cameraImageEncodings)</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;hhaha&quot;</span>, matchs)</span><br><span class="line">            <span class="keyword">for</span> index, <span class="keyword">match</span> <span class="keyword">in</span> <span class="built_in">enumerate</span>(matchs):</span><br><span class="line">                <span class="keyword">if</span> <span class="keyword">match</span>:</span><br><span class="line">                    <span class="comment"># 有一个匹配就返回</span></span><br><span class="line">                    <span class="built_in">print</span>(<span class="string">&quot;图像: &quot;</span>, personNames[index], <span class="string">&quot;匹配成功&quot;</span>)</span><br><span class="line">                    <span class="keyword">return</span> <span class="literal">True</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># 打开摄像头, 监听鼠标事件</span></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">onMouse</span>(<span class="params">self, event, x, y, flags, param</span>):</span><br><span class="line">        <span class="comment"># 点击左键, 重置click状态</span></span><br><span class="line">        <span class="keyword">if</span> event == cv2.EVENT_LBUTTONUP:</span><br><span class="line">            <span class="variable language_">self</span>.clicked = <span class="literal">True</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">savePicture</span>(<span class="params">self</span>):</span><br><span class="line">        <span class="comment"># 打开摄像头</span></span><br><span class="line">        <span class="comment"># VideoCapture()中参数是0，表示打开笔记本的内置摄像头，</span></span><br><span class="line">        <span class="comment"># 参数是视频文件路径则打开视频</span></span><br><span class="line">        cameraCapture = cv2.VideoCapture(<span class="number">0</span>)</span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> cameraCapture.isOpened():</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;摄像头未打开~~&quot;</span>)</span><br><span class="line">            exit()</span><br><span class="line">        cameraCapture.<span class="built_in">set</span>(<span class="number">3</span>, <span class="number">100</span>)</span><br><span class="line">        <span class="comment"># 帧宽度和帧高度都设置为100像素</span></span><br><span class="line">        cameraCapture.<span class="built_in">set</span>(<span class="number">4</span>, <span class="number">100</span>)</span><br><span class="line">        cv2.namedWindow(<span class="string">&#x27;MyWindow&#x27;</span>)</span><br><span class="line">        cv2.setMouseCallback(<span class="string">&#x27;MyWindow&#x27;</span>, <span class="variable language_">self</span>.onMouse)</span><br><span class="line">        <span class="comment"># 点击左键保存</span></span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&#x27;showing camera feed. Click window or press and key to stop.&#x27;</span>)</span><br><span class="line">        result, image = cameraCapture.read()</span><br><span class="line">        <span class="comment"># True/False 是否读取到照片</span></span><br><span class="line">        <span class="built_in">print</span>(result)</span><br><span class="line"></span><br><span class="line">        <span class="comment"># 点击鼠标左键后, 保存图片, 关闭窗口</span></span><br><span class="line">        <span class="keyword">while</span> result <span class="keyword">and</span> cv2.waitKey(<span class="number">1</span>) == -<span class="number">1</span> <span class="keyword">and</span> <span class="keyword">not</span> <span class="variable language_">self</span>.clicked:</span><br><span class="line">            cv2.imshow(<span class="string">&#x27;MyWindow&#x27;</span>, cv2.flip(image, <span class="number">0</span>))</span><br><span class="line">            result, image = cameraCapture.read()</span><br><span class="line">            name = <span class="variable language_">self</span>.SUCCESS_DIR + <span class="string">&#x27;image_0.jpg&#x27;</span></span><br><span class="line">            cv2.imwrite(name, image)</span><br><span class="line">        cv2.destroyWindow(<span class="string">&#x27;MyWindow&#x27;</span>)</span><br><span class="line">        cameraCapture.release()</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    authByFace = AuthByFace(<span class="literal">False</span>, <span class="literal">False</span>)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 仓库没有照片则先录入照片</span></span><br><span class="line">    files = os.listdir(authByFace.SUCCESS_DIR)</span><br><span class="line">    <span class="keyword">if</span> <span class="built_in">len</span>(files) &lt; <span class="number">1</span>:</span><br><span class="line">        authByFace.savePicture()</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="comment"># 锁定状态才会走这个认证逻辑</span></span><br><span class="line">        <span class="comment"># 每1分钟运行一次认证</span></span><br><span class="line">        <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">            time.sleep(<span class="number">10</span>)</span><br><span class="line">            <span class="keyword">try</span>:</span><br><span class="line">                isSuccess = authByFace.isAuthSuccess()</span><br><span class="line">                <span class="keyword">if</span> authByFace.clocked <span class="keyword">and</span> isSuccess:</span><br><span class="line">                    <span class="comment"># 认证通过则解开锁屏</span></span><br><span class="line">                    <span class="built_in">print</span>(<span class="string">&quot;认证通过&quot;</span>)</span><br><span class="line">                    <span class="comment"># 输入锁屏密码</span></span><br><span class="line">                    pyautogui.typewrite(<span class="string">&quot;1&quot;</span>)</span><br><span class="line">                    pyautogui.press(<span class="string">&quot;enter&quot;</span>)</span><br><span class="line">                    pyautogui.press(<span class="string">&quot;Esc&quot;</span>)</span><br><span class="line">                    authByFace.clocked = <span class="literal">False</span></span><br><span class="line">                <span class="keyword">elif</span> <span class="keyword">not</span> isSuccess:</span><br><span class="line">                    <span class="comment"># 如果认证不通过, 调用系统快捷键, 锁定屏幕</span></span><br><span class="line">                    pyautogui.hotkey(<span class="string">&#x27;win&#x27;</span>, <span class="string">&#x27;c&#x27;</span>)</span><br><span class="line">                    pyautogui.press([<span class="string">&#x27;l&#x27;</span>], interval=<span class="number">0.1</span>)</span><br><span class="line">                    <span class="comment"># 对象设置为锁定状态</span></span><br><span class="line">                    authByFace.clocked = <span class="literal">True</span></span><br><span class="line">            <span class="keyword">except</span> Exception <span class="keyword">as</span> exc:</span><br><span class="line">                <span class="built_in">print</span>(<span class="built_in">type</span>(exc))</span><br><span class="line">                <span class="keyword">if</span> <span class="keyword">not</span> authByFace.clocked:</span><br><span class="line">                    pyautogui.hotkey(<span class="string">&#x27;win&#x27;</span>, <span class="string">&#x27;c&#x27;</span>)</span><br><span class="line">                    pyautogui.press([<span class="string">&#x27;l&#x27;</span>], interval=<span class="number">0.1</span>)</span><br><span class="line">                    <span class="comment"># 对象设置为锁定状态</span></span><br><span class="line">                    authByFace.clocked = <span class="literal">True</span></span><br></pre></td></tr></table></figure>

<h1 id="开启启动"><a href="#开启启动" class="headerlink" title="开启启动"></a>开启启动</h1><h2 id="方式1-systemd-未通过"><a href="#方式1-systemd-未通过" class="headerlink" title="方式1 systemd (未通过)"></a>方式1 systemd (未通过)</h2><p><strong>经过测试,<br>无法将该程序放入到systemd单元，跟cv2等包有关系，引入就启动失败</strong></p>
<h2 id="方式2"><a href="#方式2" class="headerlink" title="方式2"></a>方式2</h2><p>直接加入到i3wm的开机启动即可，加载该文件时图形界面已经加载，正合适</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">exec --no-startup-id /usr/bin/python ~/workspace/python/demo/AuthByFace.py &gt; /tmp/authByFace.log 2&gt;&amp;1</span><br></pre></td></tr></table></figure>

<h1 id="参考"><a href="#参考" class="headerlink" title="参考"></a>参考</h1><p><a href="https://www.cnblogs.com/sclu/p/12626553.html">https://www.cnblogs.com/sclu/p/12626553.html</a></p>
<h1 id="问题列表"><a href="#问题列表" class="headerlink" title="问题列表"></a>问题列表</h1><h2 id="解决python安装opencv速度慢"><a href="#解决python安装opencv速度慢" class="headerlink" title="解决python安装opencv速度慢"></a>解决python安装opencv速度慢</h2><p>使用清华镜像（速度快）</p>
<p>pip install –user -i <a href="https://pypi.tuna.tsinghua.edu.cn/simple">https://pypi.tuna.tsinghua.edu.cn/simple</a><br>opencv-python</p>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="http://zhaozhiwei1992.github.io/2022/03/14/cpu%E5%BC%82%E5%B8%B8%E5%88%86%E6%9E%90%E4%BC%98%E5%8C%96/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.jpg">
      <meta itemprop="name" content="Mr.zhao">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="离线de日常">
      <meta itemprop="description" content="show me your code">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | 离线de日常">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2022/03/14/cpu%E5%BC%82%E5%B8%B8%E5%88%86%E6%9E%90%E4%BC%98%E5%8C%96/" class="post-title-link" itemprop="url">cpu异常分析优化</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2022-03-14 00:00:00" itemprop="dateCreated datePublished" datetime="2022-03-14T00:00:00+08:00">2022-03-14</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">更新于</span>
      <time title="修改时间：2025-11-12 15:40:02" itemprop="dateModified" datetime="2025-11-12T15:40:02+08:00">2025-11-12</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">分类于</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/CPU%E5%8D%A0%E7%94%A8/" itemprop="url" rel="index"><span itemprop="name">CPU占用</span></a>
        </span>
          ，
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/CPU%E5%8D%A0%E7%94%A8/%E5%B9%B6%E5%8F%91/" itemprop="url" rel="index"><span itemprop="name">并发</span></a>
        </span>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <h1 id="cpu占用飙升"><a href="#cpu占用飙升" class="headerlink" title="cpu占用飙升"></a>cpu占用飙升</h1><h2 id="现象"><a href="#现象" class="headerlink" title="现象"></a>现象</h2><p>系统访问很慢</p>
<h2 id="排查"><a href="#排查" class="headerlink" title="排查"></a>排查</h2><p>top 获取进程pid</p>
<p>top -Hp pid, 查看线程情况,获取线程id</p>
<p>print &quot;%x&quot; &quot;线程id&quot; #输出16进制线程id</p>
<p>jstack 进程pid &gt; &#x2F;tmp&#x2F;jstack.txt</p>
<p>在jstack.txt中搜索上述16进制线程id, 紧跟着就是问题原因</p>
<p>jmap</p>
<p>查看最耗费cpu的线程堆栈信息</p>
<p>cat stack |grep -i 34670 -C10 –color</p>
<h1 id="备注"><a href="#备注" class="headerlink" title="备注"></a>备注</h1><p>并发场景下使用currenthashmap替代hashmap, 避免死循环</p>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="http://zhaozhiwei1992.github.io/2022/03/14/%E6%89%A9%E5%B1%95%E5%B1%8F%E5%AE%9E%E6%88%98/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.jpg">
      <meta itemprop="name" content="Mr.zhao">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="离线de日常">
      <meta itemprop="description" content="show me your code">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | 离线de日常">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2022/03/14/%E6%89%A9%E5%B1%95%E5%B1%8F%E5%AE%9E%E6%88%98/" class="post-title-link" itemprop="url">如何将手机/平板/其它电脑作为扩展屏?</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2022-03-14 00:00:00" itemprop="dateCreated datePublished" datetime="2022-03-14T00:00:00+08:00">2022-03-14</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">分类于</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/%E8%BD%AF%E4%BB%B6/" itemprop="url" rel="index"><span itemprop="name">软件</span></a>
        </span>
          ，
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/%E8%BD%AF%E4%BB%B6/%E5%B7%A5%E5%85%B7/" itemprop="url" rel="index"><span itemprop="name">工具</span></a>
        </span>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <h1 id="普通屏幕"><a href="#普通屏幕" class="headerlink" title="普通屏幕"></a>普通屏幕</h1><p>连根线就行, 跳过</p>
<h1 id="如何将手机-平板-其它电脑作为扩展屏幕"><a href="#如何将手机-平板-其它电脑作为扩展屏幕" class="headerlink" title="如何将手机&#x2F;平板&#x2F;其它电脑作为扩展屏幕"></a>如何将手机&#x2F;平板&#x2F;其它电脑作为扩展屏幕</h1><h2 id="一些可行的方案"><a href="#一些可行的方案" class="headerlink" title="一些可行的方案"></a>一些可行的方案</h2><h3 id="如果只是为了演示屏幕-方案很多-使用各种远程工具啥的都可以如anydesk-向日葵等"><a href="#如果只是为了演示屏幕-方案很多-使用各种远程工具啥的都可以如anydesk-向日葵等" class="headerlink" title="如果只是为了演示屏幕,方案很多, 使用各种远程工具啥的都可以如anydesk, 向日葵等."></a>如果只是为了演示屏幕,方案很多, 使用各种远程工具啥的都可以如anydesk, 向日葵等.</h3><h3 id="如果是扩展-那必须要是要支持部分内容到扩展屏幕"><a href="#如果是扩展-那必须要是要支持部分内容到扩展屏幕" class="headerlink" title="如果是扩展, 那必须要是要支持部分内容到扩展屏幕"></a>如果是扩展, 那必须要是要支持部分内容到扩展屏幕</h3><p>可以配置活动窗口如deskreen</p>
<p>采用vnc的工具如 VirtScreen</p>
<h2 id="前提"><a href="#前提" class="headerlink" title="前提"></a>前提</h2><p>基于Intel集显中的Virtualheads功能, 目前笔记本也是集显，没试其他方案</p>
<p>这里也是采用vnc技术来搞， 如果是用现成的推荐virtscreen</p>
<p>扩展屏在 <strong>右</strong></p>
<h2 id="环境"><a href="#环境" class="headerlink" title="环境"></a>环境</h2><p>archlinux(主) + i3wm桌面管理器</p>
<p>android(扩展) 小米平板</p>
<h2 id="xrandr设置屏幕扩展"><a href="#xrandr设置屏幕扩展" class="headerlink" title="xrandr设置屏幕扩展"></a>xrandr设置屏幕扩展</h2><p>将笔记本屏幕扩展到android平板上, 并且采用分屏方式</p>
<h3 id="查看现有配置"><a href="#查看现有配置" class="headerlink" title="查看现有配置"></a>查看现有配置</h3><p>~: xrandr</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">Screen 0: minimum 8 x 8, current 1920 x 1080, maximum 32767 x 32767</span><br><span class="line">eDP1 connected primary 1920x1080+0+0 (normal left inverted right x axis y axis) 310mm x 170mm</span><br><span class="line">   1920x1080     60.02*+  59.93  </span><br><span class="line">   1680x1050     59.88  </span><br><span class="line">   1400x1050     59.98  </span><br><span class="line">   1600x900      60.00    59.95    59.82  </span><br><span class="line">DP1 disconnected (normal left inverted right x axis y axis)</span><br><span class="line">DP2 disconnected (normal left inverted right x axis y axis)</span><br><span class="line">HDMI1 disconnected (normal left inverted right x axis y axis)</span><br><span class="line">HDMI2 disconnected (normal left inverted right x axis y axis)</span><br></pre></td></tr></table></figure>

<p>该命令显示了电脑当前的显示状态，Screen 0<br>是当前正在显示的屏幕的分辨率参数，eDP1是笔记本内置显示屏当前的分辨率参数，下面的一堆数字是该显示屏所支持的分辨率及刷新率，最底下的三行分别是<br>HDMI 接口输出及虚拟输出，如果没有连接则会显示disconnect</p>
<h3 id="增加虚拟屏幕"><a href="#增加虚拟屏幕" class="headerlink" title="增加虚拟屏幕"></a>增加虚拟屏幕</h3><ol>
<li><p>使用cvt命令获取所需分辨率的相应配置信息,<br>如我想让扩展屏幕分辨率为1920x1080</p>
<p>~: cvt 1920 1080</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"># 1920x1080 59.96 Hz (CVT 2.07M9) hsync: 67.16 kHz; pclk: 173.00 MHz</span><br><span class="line">Modeline &quot;1920x1080_60.00&quot;  173.00  1920 2048 2248 2576  1080 1083 1088 1120 -hsync +vsync</span><br></pre></td></tr></table></figure>

<p>其中第二行 Modeline <strong>后面的内容</strong> 是接下来需要的</p>
</li>
<li><p>产生新的分辨率模式 xrandr –newmode</p>
<p>~: xrandr –newmode<br>上述Modelline后边部分，或者直接使用下面命令一步到位</p>
<p>~: xrandr –newmode `cvt 1920 1080|tail -n1 |sed &#39;s&#x2F;Modeline<br>&#x2F;&#x2F;&#39; |sed &#39;s&#x2F;&quot;&#x2F;&#x2F;g&#39;`</p>
<p>此时通过查看xrandr, 多出了Virtual1部分,</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">Screen 0: minimum 8 x 8, current 1920 x 1080, maximum 32767 x 32767</span><br><span class="line">eDP1 connected primary 1920x1080+0+0 (normal left inverted right x axis y axis) 310mm x 170mm</span><br><span class="line">   1920x1080     60.02*+  59.93  </span><br><span class="line">   1680x1050     59.88  </span><br><span class="line">   1400x1050     59.98  </span><br><span class="line">DP1 disconnected (normal left inverted right x axis y axis)</span><br><span class="line">DP2 disconnected (normal left inverted right x axis y axis)</span><br><span class="line">HDMI1 disconnected (normal left inverted right x axis y axis)</span><br><span class="line">HDMI2 disconnected (normal left inverted right x axis y axis)</span><br><span class="line">VIRTUAL1 disconnected (normal left inverted right x axis y axis)</span><br><span class="line">  1920x1080_60.00 (0x20a) 173.000MHz -HSync +VSync</span><br><span class="line">        h: width  1920 start 2048 end 2248 total 2576 skew    0 clock  67.16KHz</span><br><span class="line">        v: height 1080 start 1083 end 1088 total 1120           clock  59.96Hz</span><br></pre></td></tr></table></figure>
</li>
<li><p>启用新的显示器</p>
<p>~: xrandr –addmode VIRTUAL1 &quot;1920x1080_60.00&quot;<br><strong>注意VIRTUAL1变成了connected</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">VIRTUAL1 connected (normal left inverted right x axis y axis)</span><br><span class="line">  1920x1080_60.00  59.96  </span><br></pre></td></tr></table></figure>

<p>xrandr –output VIRTUAL1 –right-of eDP1 –auto <strong>eDP1为主屏幕,<br>扩展屏幕在右边,所以使用right-of,<br>该命令最好执行两次，否则可能不生效</strong></p>
</li>
<li><p>关闭扩展屏设置</p>
<p>~: xrandr –output VIRTUAL1 –off</p>
</li>
</ol>
<h2 id="X11vnc"><a href="#X11vnc" class="headerlink" title="X11vnc"></a>X11vnc</h2><p>启动x11vnc server服务并设置扩展屏</p>
<p>x11vnc -rfbport 5900 -clip 1920x1080+1920+0 -wait 1 –defer 1 -nowf -sb<br>0</p>
<p>x11vnc -rfbport 5900 -clip xinerama1 -wait 1 –defer 1 -nowf -sb 0</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">-rfbport：指定了连接所用的端口，默认为5900也可以自行设置。</span><br><span class="line">-clip：该命令设置x11vnc映射屏幕的范围，可以使用-clip WxH+X+Y来手动设置映射范围，也可以使用-clip xinerama0来自动映射显示器，其中xinerama0为屏幕设置中从左往右数第一个显示器，以此类推xinerama1为第二个，如果你的主屏幕在左边虚拟屏幕在右边，那如果设置为xinerama0就会将主屏幕的显示内容复制到虚拟屏幕上，也就是两个屏幕的内容一样了，这时就应该设置为xinerama1。</span><br><span class="line">-wait：是两次屏幕抓取的时间间隔，默认为 20 ms 效果比较卡顿，设置为 1 的话会尽可能降低抓取时间减少延迟。</span><br><span class="line">-defer：向vnc客户端发送更新的间隔，默认也为 20 ms，设置为 1 可以尽可能提高发送频率（但对网速的要求就高了）。</span><br><span class="line">-nowf：在移动窗口到虚拟屏幕时显示内容，否则会显示为一个框。</span><br><span class="line">-sb：设置休眠时间，默认为 60s 也就是如果屏幕 60s 内没有活动的话就停止数据传送，这样会导致有时鼠标从主屏移动到虚拟屏幕时会卡顿，设置为 0 后就不会休眠了</span><br></pre></td></tr></table></figure>

<h2 id="客户端连接工具"><a href="#客户端连接工具" class="headerlink" title="客户端连接工具"></a>客户端连接工具</h2><p>安卓下可以使用bvnc</p>
<p>默认配置地址如192.168.1.xx:5900即可</p>
<h2 id="adb工具-usb连接才需要"><a href="#adb工具-usb连接才需要" class="headerlink" title="adb工具(usb连接才需要)"></a>adb工具(usb连接才需要)</h2><p>打开手机的开发者模式, 并且选择usb调试</p>
<p>电脑端安装adb工具</p>
<p>使用adb reverse tcp:5900 tcp:5900 创建代理</p>
<p>扩展端配置host地址为127.0.0.1:5900即可</p>
<h2 id="参考"><a href="#参考" class="headerlink" title="参考"></a>参考</h2><p><a href="https://blog.csdn.net/u010750137/article/details/104277527">https://blog.csdn.net/u010750137/article/details/104277527</a></p>
<h1 id="测试"><a href="#测试" class="headerlink" title="测试"></a>测试</h1><h2 id="将活动程序移动到扩展屏"><a href="#将活动程序移动到扩展屏" class="headerlink" title="将活动程序移动到扩展屏"></a>将活动程序移动到扩展屏</h2><p>Win+Shift+Right</p>
<h2 id="光标定位扩展屏"><a href="#光标定位扩展屏" class="headerlink" title="光标定位扩展屏"></a>光标定位扩展屏</h2><p>Win+Right 注意观察鼠标光标</p>
<h1 id="问题处理"><a href="#问题处理" class="headerlink" title="问题处理"></a>问题处理</h1><h2 id="安装virtscreen以来python-quamash提示编译不通过-弃用"><a href="#安装virtscreen以来python-quamash提示编译不通过-弃用" class="headerlink" title="安装virtscreen以来python-quamash提示编译不通过(弃用)"></a>安装virtscreen以来python-quamash提示编译不通过(弃用)</h2><p>python版本过高，考虑降低版本</p>
<h2 id="找不到xrandr-cannot-find-mode-1920x1080-60-00"><a href="#找不到xrandr-cannot-find-mode-1920x1080-60-00" class="headerlink" title="找不到xrandr: cannot find mode &quot;1920x1080_60.00&quot;"></a>找不到xrandr: cannot find mode &quot;1920x1080_60.00&quot;</h2><p>执行该命令时提示上述错误xrandr –delmode VIRTUAL1 &quot;1920x1080_60.00&quot;</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">VIRTUAL1 disconnected (normal left inverted right x axis y axis)</span><br><span class="line">  1920x1080_60.00 (0x20a) 173.000MHz -HSync +VSync</span><br><span class="line">        h: width  1920 start 2048 end 2248 total 2576 skew    0 clock  67.16KHz</span><br><span class="line">        v: height 1080 start 1083 end 1088 total 1120           clock  59.96Hz</span><br></pre></td></tr></table></figure>

<p>注意这里的mode不能有双引号, 必须是1920x1080_60.00<br>而不是&quot;1920x1080_60.00&quot;</p>
<h2 id="bvnc客户端连接失败"><a href="#bvnc客户端连接失败" class="headerlink" title="bvnc客户端连接失败"></a>bvnc客户端连接失败</h2><p>确认服务端已经启动，客户端连接失败, 一般为防火墙导致</p>
<p>关闭防火墙systemctl stop iptables.service</p>
<p>增加防火墙规则(推荐)</p>
<h2 id="扩展没效果"><a href="#扩展没效果" class="headerlink" title="扩展没效果?"></a>扩展没效果?</h2><p><strong>该命令最好执行两次，否则可能不生效</strong></p>
<p>xrandr –output VIRTUAL1 –right-of eDP1 –auto</p>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="http://zhaozhiwei1992.github.io/2021/05/18/%E8%BF%81%E7%A7%BBpolardb%E9%97%AE%E9%A2%98%E4%B8%80/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.jpg">
      <meta itemprop="name" content="Mr.zhao">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="离线de日常">
      <meta itemprop="description" content="show me your code">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | 离线de日常">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2021/05/18/%E8%BF%81%E7%A7%BBpolardb%E9%97%AE%E9%A2%98%E4%B8%80/" class="post-title-link" itemprop="url">迁移polardb问题一</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2021-05-18 00:00:00" itemprop="dateCreated datePublished" datetime="2021-05-18T00:00:00+08:00">2021-05-18</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">分类于</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/%E8%BD%AF%E4%BB%B6-%E6%95%B0%E6%8D%AE%E5%BA%93/" itemprop="url" rel="index"><span itemprop="name">软件, 数据库</span></a>
        </span>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <h1 id="环境"><a href="#环境" class="headerlink" title="环境"></a>环境</h1><h2 id="polardb版本"><a href="#polardb版本" class="headerlink" title="polardb版本"></a>polardb版本</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">&lt;dependency&gt;</span><br><span class="line">  &lt;groupId&gt;com.aliyun&lt;/groupId&gt;</span><br><span class="line">  &lt;artifactId&gt;polardb-jdbc18&lt;/artifactId&gt;</span><br><span class="line">  &lt;version&gt;1.0.0&lt;/version&gt;</span><br><span class="line">  &lt;scope&gt;system&lt;/scope&gt;</span><br><span class="line">  &lt;systemPath&gt;$&#123;lib.dir&#125;/polardb-jdbc18.jar&lt;/systemPath&gt;</span><br><span class="line">&lt;/dependency&gt;</span><br></pre></td></tr></table></figure>

<h2 id="mybatis版本"><a href="#mybatis版本" class="headerlink" title="mybatis版本"></a>mybatis版本</h2><p><strong>直接使用springboot引入</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&lt;dependency&gt;</span><br><span class="line">  &lt;groupId&gt;org.mybatis.spring.boot&lt;/groupId&gt;</span><br><span class="line">  &lt;artifactId&gt;mybatis-spring-boot-starter&lt;/artifactId&gt;</span><br><span class="line">  &lt;version&gt;2.1.4&lt;/version&gt;</span><br><span class="line">&lt;/dependency&gt;</span><br></pre></td></tr></table></figure>

<h1 id="问题描述"><a href="#问题描述" class="headerlink" title="问题描述"></a>问题描述</h1><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">javax.servlet.ServletException: org.springframework.dao.DataIntegrityViolationException: </span><br><span class="line">### The error may exist in com/xx/templatedef/dao/oracle/XXTemplateDef_SqlMap.xml</span><br><span class="line">### The error may involve com.xx.templatedef.dao.XXTemplateDefDao.selectTemplateDefByCategoryAndState-Inline</span><br><span class="line">### The error occurred while setting parameters</span><br><span class="line">### SQL: select * from act_xx_tem_def where category=? and deploy_state=1</span><br><span class="line">### Cause: com.aliyun.polardb.util.PSQLException: 不良的类型值 long : </span><br><span class="line">com.aliyun.polardb.util.PSQLException: canot convert the column of type BYTEA to requested type long;</span><br></pre></td></tr></table></figure>

<h2 id="原因"><a href="#原因" class="headerlink" title="原因"></a>原因</h2><p>mybatis查询act_tem_def表涉及到blob字段(content_bytes)，<br>默认的BlobTypeHandler的getBlob方法不适用, 需要重写handler</p>
<h1 id="解决方案"><a href="#解决方案" class="headerlink" title="解决方案"></a>解决方案</h1><ol>
<li>在业务下重写BlobTypeHandler, 获取getBinaryStream然后转换byte数组</li>
<li>mapper.xml -&gt; resultmap中, 加入下述转换</li>
</ol>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&lt;result column=&quot;CONTENT_BYTES&quot; property=&quot;contentBytes&quot; jdbcType=&quot;BLOB&quot;</span><br><span class="line">  typeHandler=&quot;com.example.springbootpolardb.handler.PolarDbBlobTypeHandler&quot;/&gt;</span><br></pre></td></tr></table></figure>

<h2 id="转换逻辑"><a href="#转换逻辑" class="headerlink" title="转换逻辑"></a>转换逻辑</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">public static byte[] toByteArray(InputStream input) throws IOException &#123;</span><br><span class="line">    ByteArrayOutputStream output = new ByteArrayOutputStream();</span><br><span class="line">    byte[] buffer = new byte[4096];</span><br><span class="line">    int n = 0;</span><br><span class="line">    while (-1 != (n = input.read(buffer))) &#123;</span><br><span class="line">        output.write(buffer, 0, n);</span><br><span class="line">    &#125;</span><br><span class="line">    return output.toByteArray();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h1 id="代码"><a href="#代码" class="headerlink" title="代码"></a>代码</h1><ul>
<li><a href="https://github.com/zhaozhiwei1992/demo/tree/master/springboot/springboot-polardb">springboot-polardb</a></li>
</ul>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="http://zhaozhiwei1992.github.io/2021/01/26/%E8%BD%AF%E4%BB%B6%E7%BB%88%E9%AA%8C%E6%B5%8B%E8%AF%95%E6%8A%A5%E5%91%8A/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.jpg">
      <meta itemprop="name" content="Mr.zhao">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="离线de日常">
      <meta itemprop="description" content="show me your code">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | 离线de日常">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2021/01/26/%E8%BD%AF%E4%BB%B6%E7%BB%88%E9%AA%8C%E6%B5%8B%E8%AF%95%E6%8A%A5%E5%91%8A/" class="post-title-link" itemprop="url">软件终验测试报告</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2021-01-26 00:00:00" itemprop="dateCreated datePublished" datetime="2021-01-26T00:00:00+08:00">2021-01-26</time>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <p>::: {.center}<br><strong>xx公司</strong></p>
<p><strong>2020-01-01</strong><br>:::</p>
<p><strong>文档管理</strong></p>
<p>合理地管理主文档，<br>确保文档版本的及时更新，同时保持备份文档和源文档的一致性。</p>
<p><strong>版本管理</strong></p>
<hr>
<p>本版本修订日期   2019-08-12   生效日期   2019-08-12</p>
<hr>
<p>版本   生效日期     变更内容       编制人</p>
<hr>
<p>V1.0   2020-01-01   初稿编写完成   xx</p>
<h1 id="测试目的"><a href="#测试目的" class="headerlink" title="测试目的"></a>测试目的</h1><p>终验测试是项目终验的组成部分，用于各方现场验证系统各功能可用，试运行中发现的问题是否已经解决。</p>
<h1 id="测试对象"><a href="#测试对象" class="headerlink" title="测试对象"></a>测试对象</h1><p>描述所测试的软件系统名、版本等信息</p>
<h1 id="测试方式"><a href="#测试方式" class="headerlink" title="测试方式"></a>测试方式</h1><p>由业主方、承建方、监理方、总集方代表在用户现场，依据本方案进行测试，并记录测试结果，时间以半天到一天为宜。测试结束后，现场编制终验测试报告并由各方签字确认。</p>
<h1 id="测试通过准则"><a href="#测试通过准则" class="headerlink" title="测试通过准则"></a>测试通过准则</h1><p>终验测试方案中所列所有测试项均已通过，则终验测试通过，否则为不通过。</p>
<h1 id="测试时间"><a href="#测试时间" class="headerlink" title="测试时间"></a>测试时间</h1><p>说明实施测试的时间</p>
<h1 id="测试地点"><a href="#测试地点" class="headerlink" title="测试地点"></a>测试地点</h1><p>说明实施测试的地点</p>
<h1 id="测试参与人员"><a href="#测试参与人员" class="headerlink" title="测试参与人员"></a>测试参与人员</h1><p>说明参与终验测试的各方人员，要说明所属单位</p>
<h1 id="功能测试结果记录"><a href="#功能测试结果记录" class="headerlink" title="功能测试结果记录"></a>功能测试结果记录</h1><p>根据终验测试方案，以表格的方式列出各项所测功能是否通过</p>
<h1 id="问题解决情况记录"><a href="#问题解决情况记录" class="headerlink" title="问题解决情况记录"></a>问题解决情况记录</h1><p>根据终验测试方案，以表格的方式列出各项所测问题是否全部解决</p>
<h1 id="测试结论"><a href="#测试结论" class="headerlink" title="测试结论"></a>测试结论</h1><p>给出终验测试是否通过的结论。</p>
<h1 id="内容审核要点："><a href="#内容审核要点：" class="headerlink" title="内容审核要点："></a>内容审核要点：</h1><h1 id="参考"><a href="#参考" class="headerlink" title="参考"></a>参考</h1><p><a href="https://www.jianshu.com/p/a7984927cfb9">https://www.jianshu.com/p/a7984927cfb9</a></p>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="http://zhaozhiwei1992.github.io/2021/01/26/%E8%BD%AF%E4%BB%B6%E7%BB%88%E9%AA%8C%E6%B5%8B%E8%AF%95%E6%96%B9%E6%A1%88/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.jpg">
      <meta itemprop="name" content="Mr.zhao">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="离线de日常">
      <meta itemprop="description" content="show me your code">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | 离线de日常">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2021/01/26/%E8%BD%AF%E4%BB%B6%E7%BB%88%E9%AA%8C%E6%B5%8B%E8%AF%95%E6%96%B9%E6%A1%88/" class="post-title-link" itemprop="url">软件终验测试方案</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2021-01-26 00:00:00" itemprop="dateCreated datePublished" datetime="2021-01-26T00:00:00+08:00">2021-01-26</time>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <p>::: {.center}<br><strong>xx公司</strong></p>
<p><strong>2020-01-01</strong><br>:::</p>
<p><strong>文档管理</strong></p>
<p>合理地管理主文档，<br>确保文档版本的及时更新，同时保持备份文档和源文档的一致性。</p>
<p><strong>版本管理</strong></p>
<hr>
<p>本版本修订日期   2019-08-12   生效日期   2019-08-12</p>
<hr>
<p>版本   生效日期     变更内容       编制人</p>
<hr>
<p>V1.0   2020-01-01   初稿编写完成   xx</p>
<h1 id="测试目的"><a href="#测试目的" class="headerlink" title="测试目的"></a>测试目的</h1><p>终验测试是项目终验的组成部分，用于各方现场验证系统各功能可用，试运行中发现的问题是否已经解决。</p>
<h1 id="测试对象"><a href="#测试对象" class="headerlink" title="测试对象"></a>测试对象</h1><p>描述所测试的软件系统名、版本等信息</p>
<h1 id="测试方式"><a href="#测试方式" class="headerlink" title="测试方式"></a>测试方式</h1><p>由业主方、承建方、监理方、总集方代表在用户现场，依据本方案进行测试，并记录测试结果，时间以半天到一天为宜。测试结束后，现场编制终验测试报告并由各方签字确认。</p>
<h1 id="测试通过准则"><a href="#测试通过准则" class="headerlink" title="测试通过准则"></a>测试通过准则</h1><p>本测试方案中所列所有测试项均已通过，则终验测试通过，否则为不通过。</p>
<h1 id="功能测试"><a href="#功能测试" class="headerlink" title="功能测试"></a>功能测试</h1><h2 id="功能名1"><a href="#功能名1" class="headerlink" title="功能名1"></a>功能名1</h2><p>以表格方式列出子功能、测试方法、是否通过、备注</p>
<h2 id="功能名2"><a href="#功能名2" class="headerlink" title="功能名2"></a>功能名2</h2><p>。。。</p>
<h1 id="试运行期间问题解决情况测试"><a href="#试运行期间问题解决情况测试" class="headerlink" title="试运行期间问题解决情况测试"></a>试运行期间问题解决情况测试</h1><p>以表格方式列出问题、问题描述、测试方法、是否通过、备注</p>
<h1 id="内容审核要点："><a href="#内容审核要点：" class="headerlink" title="内容审核要点："></a>内容审核要点：</h1><h1 id="参考"><a href="#参考" class="headerlink" title="参考"></a>参考</h1><p><a href="https://www.jianshu.com/p/a7984927cfb9">https://www.jianshu.com/p/a7984927cfb9</a></p>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="http://zhaozhiwei1992.github.io/2021/01/26/%E8%BD%AF%E4%BB%B6%E8%AF%A6%E7%BB%86%E8%AE%BE%E8%AE%A1%E8%AF%B4%E6%98%8E/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.jpg">
      <meta itemprop="name" content="Mr.zhao">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="离线de日常">
      <meta itemprop="description" content="show me your code">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | 离线de日常">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2021/01/26/%E8%BD%AF%E4%BB%B6%E8%AF%A6%E7%BB%86%E8%AE%BE%E8%AE%A1%E8%AF%B4%E6%98%8E/" class="post-title-link" itemprop="url">软件详细设计说明</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2021-01-26 00:00:00" itemprop="dateCreated datePublished" datetime="2021-01-26T00:00:00+08:00">2021-01-26</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">分类于</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/%E8%BD%AF%E4%BB%B6%E8%AE%BE%E8%AE%A1/" itemprop="url" rel="index"><span itemprop="name">软件设计</span></a>
        </span>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <p>::: {.center}<br><strong>xx公司</strong></p>
<p><strong>2020-01-01</strong><br>:::</p>
<p><strong>文档管理</strong></p>
<p>合理地管理主文档，<br>确保文档版本的及时更新，同时保持备份文档和源文档的一致性。</p>
<p><strong>版本管理</strong></p>
<hr>
<p>本版本修订日期   2019-08-12   生效日期   2019-08-12</p>
<hr>
<p>版本   生效日期     变更内容       编制人</p>
<hr>
<p>V1.0   2020-01-01   初稿编写完成   xx</p>
<h1 id="引言"><a href="#引言" class="headerlink" title="引言"></a>引言</h1><h2 id="编写目的"><a href="#编写目的" class="headerlink" title="编写目的"></a>编写目的</h2><p>说明编写这份详细设计说明书的目的，指出预期的读者范围。</p>
<h2 id="背景"><a href="#背景" class="headerlink" title="背景"></a>背景</h2><p>说明：</p>
<p>待开发的软件系统的名称；</p>
<p>列出本项目的任务提出者、开发者、用户以及将运行该项软件的单位。</p>
<h2 id="术语和缩略语"><a href="#术语和缩略语" class="headerlink" title="术语和缩略语"></a>术语和缩略语</h2><p>列出本文件中用到的专门术语的定义和缩写词的原词组。</p>
<h2 id="参考资料"><a href="#参考资料" class="headerlink" title="参考资料"></a>参考资料</h2><p>列出要用到的参考资料，如：</p>
<p>本项目的经核准的计划任务书或合同、上级机关的批文；</p>
<p>属于本项目的其他已发表的文件，包括软件需求说明书、软件概要设计说明等；</p>
<p>本文件中各处引用的文件、资料，包括所要用到的软件开发标准。</p>
<p>列出这些文件的标题、文件编号、发表日期和出版单位，说明能够得到这些文件资料的来源。</p>
<h1 id="系统结构"><a href="#系统结构" class="headerlink" title="系统结构"></a>系统结构</h1><p>以表格方式列出本程序系统内的每个程序（包括每个模块和子程序）的名称、标识符和它们之间的层次结构关系。并用文字说明每个程序完成的功能，以及互相之间的调用关系。</p>
<h1 id="程序1（标识符）设计说明"><a href="#程序1（标识符）设计说明" class="headerlink" title="程序1（标识符）设计说明"></a>程序1（标识符）设计说明</h1><p>从本章开始，逐个地给出各个层次中的每个程序的详细设计。以下给出的提纲是针对一般情况的。对于一个具体的模块，可能根据需要在其说明条目上有适当增减。</p>
<h2 id="程序描述"><a href="#程序描述" class="headerlink" title="程序描述"></a>程序描述</h2><p>给出对该程序的简要描述，主要说明安排设计本程序的目的意义，并且说明本程序的特点。</p>
<h2 id="功能"><a href="#功能" class="headerlink" title="功能"></a>功能</h2><p>说明该程序应具有的功能，可采用IPO图（即输入－处理－输出图）的形式。</p>
<h2 id="性能"><a href="#性能" class="headerlink" title="性能"></a>性能</h2><p>说明对该程序的全部性能要求，包括对精度、灵活性和时间特性的要求。</p>
<h2 id="输入项"><a href="#输入项" class="headerlink" title="输入项"></a>输入项</h2><p>给出对每一个输入项的特性，包括名称、标识、数据的类型和格式、数据值的有效范围、输入的方式、数量和频度、输入媒体、输入数据的来源和安全保密条件等等。</p>
<h2 id="输出项"><a href="#输出项" class="headerlink" title="输出项"></a>输出项</h2><p>给出对每一个输出项的特性，包括名称、标识、数据的类型和格式、数据值的有效范围、输出的形式、数量和频度、输出媒体、对输出图形及符号的说明、安全保密条件等等。</p>
<h2 id="算法"><a href="#算法" class="headerlink" title="算法"></a>算法</h2><p>详细说明本程序所选用的算法，具体的计算公式和计算步骤。</p>
<h2 id="流程逻辑"><a href="#流程逻辑" class="headerlink" title="流程逻辑"></a>流程逻辑</h2><p>用图表（例如流程图、判定表等）辅以必要的说明来表示本程序的逻辑流程。</p>
<h2 id="接口"><a href="#接口" class="headerlink" title="接口"></a>接口</h2><p>用图的形式说明本程序所隶属的上一层模块及隶属于本程序的下一层模块、子程序，说明参数赋值和调用方式，说明与本程序相直接关联的数据结构。</p>
<h2 id="限制条件"><a href="#限制条件" class="headerlink" title="限制条件"></a>限制条件</h2><p>说明本程序运行中所受到的限制条件。</p>
<h2 id="单元测试"><a href="#单元测试" class="headerlink" title="单元测试"></a>单元测试</h2><p>说明对本程序进行单元测试的计划和方式，包括单元测试用例的设计等。</p>
<h2 id="尚未解决的问题"><a href="#尚未解决的问题" class="headerlink" title="尚未解决的问题"></a>尚未解决的问题</h2><p>说明在本程序的设计中尚未解决而设计者认为在软件完成之前应解决的问题。</p>
<h1 id="程序2（标识符）设计说明"><a href="#程序2（标识符）设计说明" class="headerlink" title="程序2（标识符）设计说明"></a>程序2（标识符）设计说明</h1><p>．．．．．．</p>
<h1 id="内容审核要点："><a href="#内容审核要点：" class="headerlink" title="内容审核要点："></a>内容审核要点：</h1><p>本文档内容与概要设计说明、软件需求规格说明等文档中的内容是否一致性；</p>
<p>所述内容是否完备；</p>
<p>各子程序模块描述是否清楚；</p>
<p>是否有必要的单元测试用例编制方面的考虑；</p>
<p>程序模块间关系是否清楚准确。</p>
<h1 id="参考"><a href="#参考" class="headerlink" title="参考"></a>参考</h1><p><a href="https://www.jianshu.com/p/a7984927cfb9">https://www.jianshu.com/p/a7984927cfb9</a></p>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="http://zhaozhiwei1992.github.io/2021/01/24/%E8%BD%AF%E4%BB%B6%E6%B5%8B%E8%AF%95%E6%8A%A5%E5%91%8A/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.jpg">
      <meta itemprop="name" content="Mr.zhao">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="离线de日常">
      <meta itemprop="description" content="show me your code">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | 离线de日常">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2021/01/24/%E8%BD%AF%E4%BB%B6%E6%B5%8B%E8%AF%95%E6%8A%A5%E5%91%8A/" class="post-title-link" itemprop="url">软件测试报告</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2021-01-24 00:00:00" itemprop="dateCreated datePublished" datetime="2021-01-24T00:00:00+08:00">2021-01-24</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">分类于</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/%E8%BD%AF%E4%BB%B6%E5%BC%80%E5%8F%91/" itemprop="url" rel="index"><span itemprop="name">软件开发</span></a>
        </span>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <p>::: {.center}<br><strong>xx公司</strong></p>
<p><strong>2020-01-01</strong><br>:::</p>
<p><strong>文档管理</strong></p>
<p>合理地管理主文档，<br>确保文档版本的及时更新，同时保持备份文档和源文档的一致性。</p>
<p><strong>版本管理</strong></p>
<hr>
<p>本版本修订日期   2019-08-12   生效日期   2019-08-12</p>
<hr>
<p>版本   生效日期     变更内容       编制人</p>
<hr>
<p>V1.0   2020-01-01   初稿编写完成   xx</p>
<h1 id="引言"><a href="#引言" class="headerlink" title="引言"></a>引言</h1><h2 id="标识"><a href="#标识" class="headerlink" title="标识"></a>标识</h2><p>本条应包含本文档及其所适用的系统和软件的完整标识，(若适用)包括标识号、标题、缩略词语、版本号、发行号。</p>
<h2 id="系统概述"><a href="#系统概述" class="headerlink" title="系统概述"></a>系统概述</h2><p>本条简述本文档适用的系统和软件的用途。应描述系统与软件的一般性质；描述系统基本功能；概述本系统或软件的开发、测试、试运行和维护的历史；标识项目的承建方、业主方、总集方、监理方等；标识系统当前和计划的运行现场；</p>
<h2 id="文档概述"><a href="#文档概述" class="headerlink" title="文档概述"></a>文档概述</h2><p>本条应概括本文档的用途与内容，并描述与其使用有关的保密性方面的要求。</p>
<h2 id="引用文件"><a href="#引用文件" class="headerlink" title="引用文件"></a>引用文件</h2><p>本条应列出本文档引用的所有文档的编号、标题、修订版本、日期和来源。</p>
<h2 id="术语与缩略语"><a href="#术语与缩略语" class="headerlink" title="术语与缩略语"></a>术语与缩略语</h2><p>提供此文档中用到的专门术语的定义和缩写词的原词组。</p>
<h1 id="测试概述"><a href="#测试概述" class="headerlink" title="测试概述"></a>测试概述</h1><h2 id="测试目的"><a href="#测试目的" class="headerlink" title="测试目的"></a>测试目的</h2><p>描述本次测试的目的。</p>
<h2 id="测试内容"><a href="#测试内容" class="headerlink" title="测试内容"></a>测试内容</h2><p>描述本次测试的主要内容，包括需要进行测试的功能和特性。可以引用测试计划和测试说明文档中的内容。对于出厂测试，要将用户文档的正确性测试作为测试的内容之一。</p>
<h2 id="测试的质量目标"><a href="#测试的质量目标" class="headerlink" title="测试的质量目标"></a>测试的质量目标</h2><p>描述本次测试所要达到的质量目标，如A、B类bug低于多少个，系统响应时间、系统表现达到什么目标等等。</p>
<h2 id="测试依据"><a href="#测试依据" class="headerlink" title="测试依据"></a>测试依据</h2><p>描述本次测试的所依据的方案、文档和标准。</p>
<h2 id="测试环境描述"><a href="#测试环境描述" class="headerlink" title="测试环境描述"></a>测试环境描述</h2><p>描述本次测试的软硬件环境，包括使用的服务器的软硬件环境和配置，网络和客户端环境，部署情况说明等。与生产系统环境的差异。</p>
<h2 id="测试时间"><a href="#测试时间" class="headerlink" title="测试时间"></a>测试时间</h2><p>说明本次测试的执行时间。</p>
<h2 id="测试人员及工作量"><a href="#测试人员及工作量" class="headerlink" title="测试人员及工作量"></a>测试人员及工作量</h2><p>说明本次测试投入的人员、工作量，以及具体每个功能子模块的人员、计划工作量、实际工作量的分配。</p>
<h1 id="测试问题记录"><a href="#测试问题记录" class="headerlink" title="测试问题记录"></a>测试问题记录</h1><p>通过列表的方式列出测试发现的主要问题记录，包括问题编号、问题说明、对应测试用例、解决情况等。</p>
<h1 id="测试结果分析及软件评价"><a href="#测试结果分析及软件评价" class="headerlink" title="测试结果分析及软件评价"></a>测试结果分析及软件评价</h1><h2 id="对被测试软件的总体评价"><a href="#对被测试软件的总体评价" class="headerlink" title="对被测试软件的总体评价"></a>对被测试软件的总体评价</h2><p>根据本报告中所展示的测试结果，提供对该软件的总体评价，包括遗留bug的统计与分析、软件存在的主要问题、是否达到本次测试的质量目标等。</p>
<h2 id="测试技术分析"><a href="#测试技术分析" class="headerlink" title="测试技术分析"></a>测试技术分析</h2><p>分析测试技术对测试结果的影响。</p>
<h2 id="测试环境的影响"><a href="#测试环境的影响" class="headerlink" title="测试环境的影响"></a>测试环境的影响</h2><p>对测试环境与操作环境的差异进行评估，并分析这种差异对测试结果的影响。</p>
<h2 id="改进建议"><a href="#改进建议" class="headerlink" title="改进建议"></a>改进建议</h2><p>针对对被测试软件还存在的问题，提出改进建议。 </p>
<h1 id="附录"><a href="#附录" class="headerlink" title="附录"></a>附录</h1><p>附录可用来提供那些为便于文档维护而单独出版的信息(例如图表、分类数据)。为便于处理，附录可单独装订成册。附录应按字母顺序(A,B等)编排。</p>
<p>文档中，如果定义了缺陷等级分类代码，需要在附录中给出其定义。</p>
<h1 id="内容审核要点："><a href="#内容审核要点：" class="headerlink" title="内容审核要点："></a>内容审核要点：</h1><p>是否全面、真实地反映了测试执行过程；测试记录是否完整、有效；</p>
<p>是否全面总结了测试执行过程中发现的软件问题和缺陷；</p>
<p>对问题及缺陷的判断和定位是否准确；</p>
<p>所测试内容与测试计划是否一致。</p>
<h1 id="参考"><a href="#参考" class="headerlink" title="参考"></a>参考</h1><p><a href="https://www.jianshu.com/p/a7984927cfb9">https://www.jianshu.com/p/a7984927cfb9</a></p>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




  <nav class="pagination">
    <a class="extend prev" rel="prev" title="上一页" aria-label="上一页" href="/page/3/"><i class="fa fa-angle-left"></i></a><a class="page-number" href="/">1</a><span class="space">&hellip;</span><a class="page-number" href="/page/3/">3</a><span class="page-number current">4</span><a class="page-number" href="/page/5/">5</a><a class="page-number" href="/page/6/">6</a><a class="extend next" rel="next" title="下一页" aria-label="下一页" href="/page/5/"><i class="fa fa-angle-right"></i></a>
  </nav>

</div>
  </main>

  <footer class="footer">
    <div class="footer-inner">

  <div class="copyright">
    &copy; 
    <span itemprop="copyrightYear">2026</span>
    <span class="with-love">
      <i class="fa fa-heart"></i>
    </span>
    <span class="author" itemprop="copyrightHolder">Mr.zhao</span>
  </div>
  <div class="powered-by">由 <a href="https://hexo.io/" rel="noopener" target="_blank">Hexo</a> & <a href="https://theme-next.js.org/" rel="noopener" target="_blank">NexT.Gemini</a> 强力驱动
  </div>

    </div>
  </footer>

  
  <div class="toggle sidebar-toggle" role="button">
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
  </div>
  <div class="sidebar-dimmer"></div>
  <div class="back-to-top" role="button" aria-label="返回顶部">
    <i class="fa fa-arrow-up fa-lg"></i>
    <span>0%</span>
  </div>
  <div class="reading-progress-bar"></div>

<noscript>
  <div class="noscript-warning">Theme NexT works best with JavaScript enabled</div>
</noscript>


  
  <script size="300" alpha="0.6" zIndex="-1" src="https://cdnjs.cloudflare.com/ajax/libs/ribbon.js/1.0.2/ribbon.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/animejs/3.2.1/anime.min.js" integrity="sha256-XL2inqUJaslATFnHdJOi9GfQ60on8Wx1C2H8DYiN1xY=" crossorigin="anonymous"></script>
<script src="/js/comments.js"></script><script src="/js/utils.js"></script><script src="/js/motion.js"></script><script src="/js/sidebar.js"></script><script src="/js/next-boot.js"></script>

  






  





</body>
</html>
